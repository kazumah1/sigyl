# Sigil MCP Registry & Hosting MVP Implementation Plan

## ğŸ¯ Project Overview
**Startup:** Sigil  
**Goal:** Build an end-to-end functional MVP for MCP Registry & Hosting

### Core Components:
- MCP Registry API (Express + PostgreSQL)
- Docker-based MCP deploys (hosted via Railway)
- CLI tool (mcp publish) that auto-generates, deploys, and registers
- Minimal web frontend (React + Vite) for discovery

## ğŸ“¦ Tech Stack
| Component | Stack | Status |
|-----------|-------|--------|
| Registry DB | Supabase (PostgreSQL) | âœ… **COMPLETE** |
| API Layer | Express (TypeScript) | ğŸš§ **NEXT STEP** |
| CLI | oclif (TypeScript) | ğŸŸ¡ **MOSTLY COMPLETE** (missing deploy) |
| Container Hosting | Docker + Railway | ğŸ“‹ **PENDING** |
| Frontend | React + Tailwind (Vite) | ğŸ“‹ **PENDING** |

## ğŸ“ Project Structure
```
mcp-platform/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ cli/                    # CLI tool (oclif) ğŸŸ¡ MOSTLY COMPLETE
â”‚   â”œâ”€â”€ registry-api/           # Registry backend service ğŸš§ NEXT STEP
â”‚   â”œâ”€â”€ container-builder/      # Docker build service ğŸ“‹ PENDING
â”‚   â”œâ”€â”€ web-frontend/          # Discovery website ğŸ“‹ PENDING
â”‚   â””â”€â”€ shared/                # Shared types/utilities ğŸ“‹ PENDING
â”œâ”€â”€ apps/
â”‚   â”œâ”€â”€ api/                   # Main API gateway ğŸ“‹ PENDING
â”‚   â””â”€â”€ docs/                  # Documentation site ğŸ“‹ PENDING
â”œâ”€â”€ infrastructure/
â”‚   â”œâ”€â”€ docker/                # Dockerfile templates ğŸ“‹ PENDING
â”‚   â”œâ”€â”€ k8s/                   # Kubernetes manifests ğŸ“‹ PENDING
â”‚   â””â”€â”€ terraform/             # Infrastructure as code ğŸ“‹ PENDING
â””â”€â”€ examples/
    â”œâ”€â”€ express-demo/          # Example MCP servers ğŸ“‹ PENDING
    â”œâ”€â”€ fastapi-demo/          # Example MCP servers ğŸ“‹ PENDING
    â””â”€â”€ generated-mcps/        # Generated MCP examples ğŸ“‹ PENDING
```

## âœ… Current Status

### STEP 1: DB Schema (Supabase) - **COMPLETE**
- âœ… PostgreSQL schema deployed to Supabase
- âœ… Tables: `mcp_packages`, `mcp_deployments`, `mcp_tools`
- âœ… Proper relationships and constraints in place

### STEP 2: Registry API (Express) - **NEXT STEP** ğŸ¯
**This is our immediate priority**

Required endpoints:
- `POST /api/v1/packages` â†’ Validate + Register + Deploy
- `GET /api/v1/packages/search` â†’ Full-text query
- `GET /api/v1/packages/:name` â†’ Detailed view

### STEP 3: Docker Builder - **PENDING**
- Docker containerization for MCP servers
- Integration with Railway deployment

### STEP 4: CLI Tool - **MOSTLY COMPLETE** ğŸŸ¡
- âœ… CLI structure and commands implemented
- âœ… Most functionality working
- âŒ **Missing: Deploy command** (needs Registry API + Container Builder)

### STEP 5: Web Frontend - **PENDING**
- React + Vite + Tailwind
- Search and discovery interface

### STEP 6: Integration Testing - **PENDING**
- End-to-end flow testing

## ğŸš€ IMMEDIATE FIRST STEP: Registry API Implementation

Since the database is set up and CLI is mostly complete, our **first implementation step** is to build the Registry API in `packages/registry-api/`.

### Key Implementation Points:
1. Set up Express server with TypeScript
2. Connect to Supabase database
3. Implement core API endpoints
4. Add proper error handling and validation
5. Set up Railway deployment configuration

### Expected Outcome:
- Working API that can register and search MCP packages
- Foundation for CLI deploy command completion
- Ready for Container Builder integration

## ğŸ”„ Updated Implementation Order

Given the CLI is mostly complete, the optimal order is:

1. **Registry API** (packages/registry-api/) - Enables CLI deploy command
2. **Container Builder** (packages/container-builder/) - Enables Docker deployment
3. **CLI Deploy Command** (packages/cli/) - Complete the missing piece
4. **Web Frontend** (packages/web-frontend/) - User-facing discovery
5. **API Gateway** (apps/api/) - Production routing and scaling
6. **Integration Testing** - End-to-end validation

## ğŸ“Š Progress Tracking
- [x] Database schema design and deployment
- [x] CLI tool core functionality (missing deploy only)
- [ ] Registry API core functionality â† **CURRENT FOCUS**
- [ ] Docker container builder
- [ ] CLI deploy command completion
- [ ] Web frontend
- [ ] API gateway setup
- [ ] End-to-end integration

## Project Plan: MCP Registry API YAML Parser

## Goal
Implement a backend parser in the registry-api package that:
- Fetches mcp.yaml from GitHub using the REST API
- Decodes and parses it into JSON
- Strictly validates the structure against the format generated by the ts-cli CLI
- Uses runtime validation (zod) and correct TypeScript types
- Handles errors for missing/invalid fields
- Makes the parsed data available for downstream use (env vars, DB, frontend, etc.)

## Current Status
- The parser now:
  - Fetches mcp.yaml from GitHub
  - Decodes and parses YAML using js-yaml
  - Validates the structure using a zod schema that matches the CLI's output
  - Uses updated types (MCPMetadata, MCPTool) that match the CLI's mcp.yaml (fields: name, description, version, tools[]; inputSchema/outputSchema for tools)
  - Throws errors on invalid structure
- The port field is removed (not present in CLI output)
- The version field is required
- inputSchema and outputSchema are used (not input_schema/output_schema)

## Next Steps
- Integrate this parser with downstream logic (env var setting, DB population, frontend rendering)
- Add tests for various valid/invalid mcp.yaml files
- Document the expected mcp.yaml format for contributors

---
*Last Updated: $(date)*
*Next Review: After Registry API completion*
